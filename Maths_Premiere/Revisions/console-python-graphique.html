<textarea id="code-editor" class="w-full h-80 p-4 bg-slate-800 text-emerald-400 font-mono rounded-lg border-2 border-slate-700 focus:border-emerald-500 outline-none shadow-inner mb-4" spellcheck="false">
def discriminant(a, b, c):
    delta = b**2 - 4*a*c
    return delta

print(f"Le discriminant de x² - 4x + 3 est : {discriminant(1, -4, 3)}")
</textarea>

<script>
    // Script d'indentation automatique
    const editor = document.getElementById('code-editor');

    editor.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
            // 1. Récupérer la position du curseur
            const start = this.selectionStart;
            const end = this.selectionEnd;
            const value = this.value;

            // 2. Trouver la ligne actuelle
            const lastNewline = value.lastIndexOf('\n', start - 1);
            const currentLine = value.substring(lastNewline + 1, start);

            // 3. Si la ligne se termine par ':', on indente
            if (currentLine.trim().endsWith(':')) {
                e.preventDefault(); // Empêche le saut de ligne classique

                // Calculer l'indentation actuelle pour la conserver + 4 espaces
                const currentIndent = currentLine.match(/^\s*/)[0];
                const newIndent = currentIndent + "    ";
                
                // Insérer le saut de ligne et l'indentation
                this.value = value.substring(0, start) + "\n" + newIndent + value.substring(end);

                // Replacer le curseur au bon endroit
                this.selectionStart = this.selectionEnd = start + 1 + newIndent.length;
            } else {
                // Optionnel : Conserver l'indentation de la ligne précédente même sans ':'
                e.preventDefault();
                const currentIndent = currentLine.match(/^\s*/)[0];
                this.value = value.substring(0, start) + "\n" + currentIndent + value.substring(end);
                this.selectionStart = this.selectionEnd = start + 1 + currentIndent.length;
            }
        }

        // Support de la touche Tab (facultatif mais recommandé)
        if (e.key === 'Tab') {
            e.preventDefault();
            const start = this.selectionStart;
            const end = this.selectionEnd;
            this.value = this.value.substring(0, start) + "    " + this.value.substring(end);
            this.selectionStart = this.selectionEnd = start + 4;
        }
    });
</script>