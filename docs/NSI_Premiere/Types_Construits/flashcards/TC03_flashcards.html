<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flashcards NSI - Dictionnaires</title>
    <style>
        :root { --primary: #2563eb; --bg: #f1f5f9; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        
        .flashcard-container { width: 600px; height: 400px; perspective: 1000px; cursor: pointer; }
        .flashcard { width: 100%; height: 100%; position: relative; transition: transform 0.6s; transform-style: preserve-3d; }
        .flashcard.flipped { transform: rotateY(180deg); }

        .front, .back {
			position: absolute; 
			width: 100%; 
			height: 100%; 
			backface-visibility: hidden;
			display: flex; 
			align-items: center; 
			justify-content: center; 
			text-align: center;
			padding: 30px; /* Augmenté pour la lisibilité */
			border-radius: 15px; 
			box-shadow: 0 8px 15px rgba(0,0,0,0.1); 
			box-sizing: border-box;
    
			/* --- CORRECTION : On autorise le flux de texte normal --- */
			display: block;           /* On repasse en block pour le texte en ligne */
			line-height: 400px;       /* Pour centrer verticalement avec la hauteur de la carte */
			overflow-wrap: break-word; 
			white-space: normal;     
		}

		/* Pour que le texte à l'intérieur soit bien centré verticalement malgré le mode block */
		.front span, .back span {
			display: inline-block;
			vertical-align: middle;
			line-height: 1.4; /* Taille de ligne normale pour le texte */
		}

        .front { background: white; color: #1e293b; font-size: 1.2rem; font-weight: bold; border: 2px solid var(--primary); }
        .back { background: var(--primary); color: white; transform: rotateY(180deg); font-size: 1.1rem; }

        .controls { margin-top: 30px; display: flex; gap: 20px; }
        button { padding: 10px 20px; border: none; border-radius: 8px; background: #1e293b; color: white; cursor: pointer; font-size: 1rem; }
        button:hover { opacity: 0.9; }
        code { background: rgba(0,0,0,0.1); padding: 2px 4px; border-radius: 4px; }
        .back code { background: rgba(255,255,255,0.2); }
    </style>
	<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
	<script>
		window.MathJax = {
			tex: {
			inlineMath: [['$', '$'], ['\\(', '\\)']],
			displayMath: [['$$', '$$'], ['\\[', '\\]']]
			}
		};
	</script>
	<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
	</head>
	<body>

		<div id="progress" style="margin-bottom: 15px; color: #64748b;">Chargement...</div>

		<div class="flashcard-container" onclick="flipCard()">
			<div class="flashcard" id="card">
				<div class="front" id="recto">Question</div>
				<div class="back" id="verso">Réponse</div>
			</div>
		</div>

		<div class="controls">
			<button onclick="prevCard(event)">Précédent</button>
			<button onclick="nextCard(event)">Suivant</button>
		</div>

    <script>
        let questions = [];
        let currentIndex = 0;

        // Fonction pour mélanger un tableau (Algorithme de Fisher-Yates)
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        async function loadQuestions() {
            try {
                const response = await fetch('TC03_questions.json');
                const data = await response.json();
                
                // On mélange les questions ici
                questions = shuffle(data); 
                
                updateCard();
            } catch (e) {
                console.error("Erreur de chargement :", e);
            }
        }

        function flipCard() {
            document.getElementById('card').classList.toggle('flipped');
        }

        function updateCard() {
			if (questions.length === 0) return;
			
			const card = document.getElementById('card');
			card.classList.remove('flipped');
			
			setTimeout(() => {
				// On entoure de <span> pour le centrage vertical défini dans le CSS
				document.getElementById('recto').innerHTML = `<span>${questions[currentIndex].recto}</span>`;
				document.getElementById('verso').innerHTML = `<span>${questions[currentIndex].verso}</span>`;
				document.getElementById('progress').innerText = `Carte ${currentIndex + 1} / ${questions.length}`;
				
				if (window.MathJax && MathJax.typesetPromise) {
					MathJax.typesetPromise();
				}
			}, 150);
		}

        function nextCard(e) {
            e.stopPropagation();
            if (currentIndex < questions.length - 1) {
                currentIndex++;
                updateCard();
            }
        }

        function prevCard(e) {
            e.stopPropagation();
            if (currentIndex > 0) {
                currentIndex--;
                updateCard();
            }
        }

        loadQuestions();
		
		
    </script>
</body>
</html>